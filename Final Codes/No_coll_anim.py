import pandas as pd 
import numpy as np
import matplotlib.animation as animation
import matplotlib.pyplot as plt

## This File contains the final animation of the improved trjaectory with no scrubbing, here the hip movement
## is considered but the step height is not corrected.  

# Joint angles calculated from inverse_kinematic.py 
q1 = np.array([-2.8331997663034563, -2.836069068023002, -2.8381856894044146, -2.839370873197443, -2.8405599491765425, -2.8426557129147474, -2.8447561258664456, -2.8463341089058316, -2.848027177698979, -2.850141108529158, -2.852258738976194, -2.853904140353114, -2.8555826112575966, -2.85767475694593, -2.8598128692928815, -2.8614880933179387, -2.863843041841583, -2.8673616379137967, -2.870935283586606, -2.8744527560320137, -2.8779110013090063, -2.8807011516782954, -2.8833444110211848, -2.8870684836570533, -2.8910387892331837, -2.894290003992071, -2.897561217531136, -2.9014445736129204, -2.905479871230114, -2.909149516485178, -2.9130428842819773, -2.918600621687282, -2.92411669013626, -2.9283066867095977, -2.932357508070063, -2.9366949975454255, -2.9410614694210633, -2.944275875188117, -2.947590098941765, -2.9523966266419377, -2.957312776955498, -2.9617919264969195, -2.9661403803779516, -2.9699592458190347, -2.973851763096236, -2.978807553873569, -2.9839403335943038, -2.9885708980794945, -2.9932124662590596, -2.9980930304204083, -3.0032591696131163, -3.0094175465384696, -3.015381918359922, -3.0198192065813942, -3.0243975229717392, -3.0295223139622847, -3.0349212367503124, -3.0406953595325916, -3.0465659793231246, -3.052685908166823, -3.0590763408567243, -3.0656546886655898, -3.0724220440570518, -3.0790703176275898, -3.0855767387845243, -3.0923458815814384, -3.099383502617199, -3.106522971936961, -3.1138256473139596, -3.12119132455652, -3.1288493104133535, -3.136699287693107, -3.1442211648191307, -3.151074188858199, -3.1581844236484047, -3.166790614182228, -3.1767749957517495, -3.1875002553485414, -3.197764942281419, -3.206693032130051, -3.215918179706673, -3.229384489329144, -3.2450435141725893, -3.2593544391580305, -3.274081925952288, -3.279066304649927, -3.2735681684402973, -3.2685892676831303, -3.2632925424691828, -3.2572453256768705, -3.2511981088845587, -3.2451508920922514, -3.2391036752999405, -3.2330564585076313, -3.2270092417153213, -3.2208503238508843, -3.2145550957718645, -3.2078959665438065, -3.2012846593372513, -3.195234300952289, -3.1892350807144076, -3.183162033049169, -3.176789661417212, -3.1699526831383746, -3.1630706753648363, -3.1562631058838946, -3.1494623431870368, -3.1427040076989634, -3.1360249660094683, -3.1298544591587985, -3.1238096683741494, -3.1170597820249863, -3.1104629610512236, -3.1044106828040814, -3.0983685274666035, -3.092308395237828, -3.0862103893642847, -3.079497154929414, -3.072214943158394, -3.0646379452767105, -3.0572583441334267, -3.0504473712604456, -3.0436610075299146, -3.0369256074135444, -3.0299350401605314, -3.02239504325899, -3.0147438688840973, -3.0071824044327573, -2.9996216381131173, 
-2.9920702965714394, -2.984537455519831, -2.9776540514828915, -2.970947623832103, -2.9633194878033353, -2.9558739132143295, -2.949068874460803, -2.94226558103653, -2.935462287612255, -2.9286572488587295, -2.9218539554344565, -2.915048916680929, -2.9082438779274042, -2.9014405845031304, -2.894635545749604, -2.8878322523253304, -2.8803727151023057, -2.8727264276493187, -2.8659266248835498, -2.859116350142268, -2.8515695464566435, -2.8440017988199955, -2.8368302409235513, -2.8302136977292403, -2.8241469332493088, -2.8181011127204005, -2.811826654059481, -2.8058523920299034, -2.8004959765555335, -2.7952338088607696, -2.7899140453006916, -2.7846536229351813, -2.7798539674921967, -2.775335310058783, -2.7706717902974547, -2.76619502076609, -2.762219160730046, -2.758445758887235, -2.754590326569579, -2.7508972098723596, -2.7482041668365325, -2.745853208334096, -2.742980396385313, -2.740034280607946, -2.7365680567134856, -2.7335660904000556, -2.731784109233768, -2.7302237848824866, -2.728591902031871, -2.727083937558149, -2.726028013360693, -2.7252199259170187, -2.724396130510077, -2.7237503586868383, -2.723951071550819, -2.7243612239250363, -2.723905692990267, -2.7236020057004193, -2.7240208847208986, -2.7244467450583842, -2.72466316588563, -2.724825481506068, -2.724938927907446, -2.724825481506068, -2.7243943851808234, -2.7239109289780234, -2.723493795286797, -2.7231429841071435, -2.723647384260973, -2.7243053733889697, -2.7242111256093646, -2.7239650341848347, -2.7233855848731703, -2.7230225563887536, -2.7234187461289583, -2.7241238591467702, -2.7248795867128797, -2.725637059608245, -2.726394532503611, -2.727152005398976, -2.7281311351093445, -2.7293057416959376, -2.7304751122947737, -2.7316619361861285, -2.7327998908584292, -2.734285166051877, -2.7368141481380164, -2.739903380914047, -2.742931527166256, -2.745954437430711, -2.7490785767917814, -2.7516302481581976, -2.7534610985435393, -2.7552779862948644, -2.7570966193754423, -2.7589169977852728, -2.7609450703760903, -2.762819553992731, -2.7643327544542107, -2.765847700244943, -2.7673609007064215, -2.7688758464971523, -2.770416972226664, -2.7724974046950397, -2.7756372520193793, -2.778995265500216, -2.7819885051673863, -2.7849991981270756, -2.788062250964326, -2.791449935042447, -2.7952634794580535, -2.799113675787954, -2.802895804277025, -2.806669206119838, -2.8103972294020982, -2.814034495563254, -2.817172597558339, -2.8201483839329904, -2.8237053649485535, -2.827314705841677, -2.8298262346352985, -2.8325035697078578, -2.836936706007921, -2.841409984880784, -2.845188622711354, -2.848965515212668, -2.852740662384732, -2.856515809556796, -2.860242087509805, -2.8642423821553744, -2.8687732568935527, -2.8734105967161003, -2.8779449621127813, -2.882477582180214, -2.8870224195524066, -2.8915899462048733, -2.896822443302352, -2.902222492008021, -2.9068127079407695, -2.9112859868136276, -2.916628439653985, -2.921799850227644, -2.924882101686664, -2.9261177947970762, -2.9265017672325175, -2.9269922047523282, -2.92785265207356, -2.928713099394789, -2.929571801386772, -2.9304322487080086, -2.9312926960292396, -2.9321531433504724])
q2 = np.array([0.9387866081961191, 0.9366261388378156, 0.9344617750715467, 0.9323134136767299, 0.9301577453666328, 0.9279664089000562, 0.9257624226663219, 0.9235698212961438, 0.9213644171550546, 0.9191292964828957, 0.9168822089300369, 0.9146537943513096, 0.9124162460565775, 0.9101426428969833, 0.9078549098798611, 0.9055945772354581, 0.9032691005564721, 0.9008137170703786, 0.8983126463123501, 0.8957790084234862, 0.893216364522559, 0.8907245719130478, 0.8882378844612481, 0.8855425586853359, 0.8827573135340059, 0.8800755408135245, 0.8773615699001788, 0.8744762110895163, 0.8715089695018275, 0.868591493557098, 0.8655751546519455, 0.8620205693290695, 0.858378030728637, 0.8550916631423807, 0.8518062831826236, 0.8483718778749563, 0.8448750074296265, 0.8417831058053393, 0.838628591913579, 0.8348266891198142, 0.8309130080831516, 0.8271309326474335, 0.8233577694034295, 0.8197908975268197, 0.8161541382950268, 0.8119449992628162, 0.8075783791909821, 0.8034128219392753, 0.799187440245683, 0.7947726487773076, 0.7901307030781629, 0.7848221349649825, 
0.7795311711233143, 0.7751205605944205, 0.7705720267989373, 0.7656105374506085, 0.7603967830379361, 0.7548470523140354, 0.7491419160728678, 0.7431643000069075, 0.7368847855724916, 0.7303520189002274, 0.723554253913144, 0.7167309108930497, 0.7099078961923527, 0.7027484490960705, 0.6952313943994115, 0.6874885110385455, 0.6794563529538351, 0.671217319371346, 0.6625456251583048, 0.6535182741151063, 0.6446441900586684, 0.6362946306327487, 0.627537669799026, 0.6170200038419272, 0.6047456067296395, 0.5913047618838585, 0.5780286033831314, 0.566015872408095, 0.5533531097055663, 0.5349211734511139, 0.5128239132073333, 0.4916203322569086, 0.46886711341259224, 0.46327147000311986, 0.47682744230335533, 0.49059110878458734, 0.504571196093053, 0.5189893610437826, 0.5334773391645898, 0.5477680950799151, 0.5617324744251238, 0.5752954280423695, 0.588835692379342, 0.6024422792278885, 0.6160523567349436, 0.6296729062175053, 0.6427977821925033, 0.6547986661292143, 0.6665429866658872, 0.6786433543699624, 0.6907419767447875, 0.7028371084611085, 0.7149304948481758, 0.7271669982339094, 0.7388013630277022, 0.7492977731491985, 0.7595690357971849, 0.770123041783993, 0.7804902975408394, 0.7903287185343308, 0.8000484571386872, 0.8098833874736766, 0.8197183178086638, 0.8296509865817641, 0.8391874656146611, 0.8482125631767237, 0.857230679421777, 0.8662505409960841, 0.8752704025703923, 0.8835851511268916, 0.8921878790099738, 0.9019495055163763, 0.911838541058177, 0.9217258312707248, 0.9317126052506373, 0.9457223631563955, 0.960864839746699, 0.9726283589051402, 0.9808942382425858, 0.9862000391686474, 0.9914901321314431, 0.9967837157527429, 1.0020493741060068, 1.005438803513381, 1.0079398603314882, 1.0117778393566244, 1.015509353297388, 1.0183874012339253, 1.0200227747430457, 1.020773266321402, 1.0215202672412564, 1.022279485465873, 1.0230334677027353, 1.0226006260482414, 1.0215883350820851, 1.0217820666290556, 1.0216546575936598, 1.0198639497811144, 1.0173384583534792, 1.014812966925843, 1.0115038226640622, 1.00648774639383, 1.0011051509806785, 0.9967488091677008, 0.9921254319791692, 0.9860429595359682, 0.9789900840286604, 0.9714362990260283, 0.9638860046818998, 0.9570163887460502, 0.9501973873585091, 0.9423626043463059, 0.933075707396443, 0.9217450298924974, 0.9104544949613447, 0.9004677209814335, 0.8905455241838456, 0.8807158298366129, 0.8708983527941454, 0.8606288354754109, 0.8486471501604707, 0.8340719055770653, 0.8179276099961175, 0.8013050942001252, 0.7847052676844051, 0.7681787449972727, 0.7529716912246446, 0.7396653010074388, 0.7268057150787459, 0.7139548557963119, 0.7011022511846272, 0.6882496465729382, 0.6753987872905066, 0.6628079820666175, 0.6506028946074223, 0.6385583774394082, 0.626522586917657, 0.6144274552013389, 0.602332323485014, 0.5908375850313826, 0.5792014749083325, 0.5668305811702004, 0.5544527061150518, 0.542034688487113, 0.5297493158823293, 0.5176559294952545, 0.5055607977789427, 0.4934674113918695, 0.4813722796755473, 0.46988975852668013, 0.4587597938867164, 0.4473453405786696, 0.4359483405631352, 0.42465606030273906, 0.41349817039474046, 0.40248863347315944, 0.3915192391243756, 0.3803281879605891, 0.3692872351124711, 0.35924984658425146, 0.3498285592819879, 0.34036538407767414, 0.33097725803119543, 0.3217287583248794, 0.3126670088485232, 0.3039194186375296, 0.295372541290512, 0.28694783699113396, 0.2789053597979437, 0.2718839002171718, 0.26596025273590346, 0.2604502482873579, 0.25547082393141773, 0.25093471320548505, 0.24640034780880388, 0.2418677277413741, 0.23733510767394328, 0.23286531945958727, 0.2285857721336973, 0.22486647549769584, 0.22130425849437851, 0.21745580749372845, 0.21330366920323368, 0.20876406781879658, 0.2041197466792412, 0.19944051895464382, 0.19470369536473064, 0.1895095955107977, 0.1844341780459977, 0.17989806732006575, 0.17536370192338113, 0.17082479867064387, 0.16628606995083323, 0.16175153002122794, 0.1572194335525735, 0.1526407367928927, 0.14797774063034153, 0.1427951599494665, 0.13748639196367562, 0.13290664800644597, 0.12815952697394434, 0.12286960854407131, 0.11757916651542927, 0.11228872448678351, 0.10699810792521158, 0.10169352872962312, 0.09634287284178752, 0.09042219242024599, 0.0839176993639151, 0.07716152982944621, 0.07037900582326434, 0.06442359334961054, 0.05798926252921238, 0.05042814714372337, 0.04286703175823639, 0.035305916372739526, 0.027744800987256152, 0.020186827194415002, 0.012691406001970773, 0.008428282224344469, 0.007504409638094789, 0.0067475650612551785, 0.0059904761383242355, 0.005232723990280075, 0.004474081724324591, 0.0031780176750829114, 0.0017138051150421274, 0.0007317310342298544, 2.6367796834847468e-15])
t = np.linspace(0,2.8,280)

# The trajectory with no collision points
no_coll_trajectory = [(-0.13716201725177513, -92.4), (-0.29163771266701843, -92.4), (-0.3764244723324133, -92.4), (-0.37594580170153336, -92.4), (-0.37545847479730554, -92.4), (-0.4570535342166657, -92.4), (-0.5384863283222288, -92.4), (-0.5721833838672161, -92.4), (-0.6159100487608846, -92.4), (-0.6971390430207087, -92.4), (-0.778152587725895, -92.4), (-0.8163994718304117, -92.4), (-0.8572733433805269, -92.4), (-0.9347018718730453, -92.4), (-1.0157234404740514, -92.4), (-1.0552405697918807, -92.4), (-1.154554425750824, -92.4), (-1.3553428694176617, -92.4), (-1.5590329898985757, -92.4), (-1.7559660208269499, -92.4), (-1.9460353588155535, -92.4), (-2.0777375671540526, -92.4), (-2.196124507185516, -92.4), (-2.4044551156051206, -92.4), (-2.631232917648237, -92.4), (-2.796517411827402, -92.4), (-2.9621231030816126, -92.4), (-3.1760816417300113, -92.4), (-3.4001483945342805, -92.4), (-3.592831868592274, -92.4), (-3.8014414901214693, -92.4), (-4.13787432613568, -92.4), (-4.466166550494602, -92.4), (-4.689158291960446, -92.4), (-4.899360436529456, -92.4), (-5.128854566890578, -92.4), (-5.358020433634824, -92.4), (-5.500397826288221, -92.4), (-5.64899286478817, -92.4), (-5.9041083333806235, -92.4), (-6.163942837791652, -92.4), (-6.389803243668364, -92.4), (-6.6040417183395554, -92.4), (-6.779389317746681, -92.4), (-6.958172656703365, -92.4), (-7.207414221260308, -92.4), (-7.465365122118968, -92.4), (-7.686696383829812, -92.4), (-7.9061481480401525, -92.4), (-8.138479806230663, -92.4), (-8.386150403974888, -92.4), (-8.693048553648818, -92.4), (-8.982855520052237, -92.4), (-9.174433016562801, -92.4), (-9.372322503391871, -92.4), (-9.600575347523549, -92.4), (-9.841843049905354, -92.4), (-10.101367181074302, -92.4), (-10.362186534669188, -92.4), (-10.632694695687299, -92.4), (-10.913393945254747, -92.4), (-11.199006946650378, -92.4), (-11.489038989083674, -92.4), (-11.766709259187664, -92.4), (-12.031174736636782, -92.4), (-12.303323712717326, -92.4), (-12.58261692842791, -92.4), (-12.860079563745614, -92.4), (-13.138239572723364, -92.4), (-13.411845832398374, -92.4), (-13.690961904077135, -92.4), (-13.970044768099147, -92.4), (-14.226029605309964, -92.4), (-14.445724478023863, -92.4), (-14.668811415242029, -92.4), (-14.942907915220434, -92.4), (-15.257029632987468, -92.4), (-15.581135398568133, -92.4), (-15.869902716993181, -92.4), (-16.096928079560193, -92.4), (-16.31830309356788, -92.4), (-16.643365780605887, -92.4), (-16.98594617254842, -92.4), (-17.245679870982826, -92.4), (-17.463173709517406, -92.4), (-17.644995861836794, -92.3618402303894), (-17.825095223252006, -92.28148907157457), (-18.063855627262065, -92.18478206382993), (-18.282679271095077, -92.0862979480564), (-18.45218035196115, -91.9909691586989), (-18.62412056331592, -91.88977915722538), (-18.784849650686837, -91.78647214822357), (-18.92785194705996, -91.68320751051571), (-19.0494175623017, -91.58152150482783), (-19.168837487646577, -91.47602050313641), (-19.28015180335472, -91.36747988197143), (-19.37789328753839, -91.257366164709), (-19.441193654382584, -91.15003384550538), (-19.483167598269628, -91.04608644827047), (-19.520333077844125, -90.9468089928711), (-19.548750760390522, -90.84795130212834), (-19.587397893853016, -90.74128885669269), (-19.597435259485163, -90.63741055651538), (-19.5635188381273, -90.5395981375938), (-19.52477570915324, -90.43959433685676), (-19.49945679857995, -90.33233849068543), (-19.444467362511734, -90.23329420439845), (-19.336869235932348, -90.15254999920494), (-19.225247057428348, -90.07229627008363), (-19.1742314222386, -89.97448048132914), (-19.125293772352265, -89.87568303108279), (-18.98513797855195, -89.79872286420763), (-18.853130411183823, -89.71913792539462), (-18.77671862088757, -89.62494055919063), (-18.701004539662648, -89.52857411587071), (-18.628170199205083, -89.4285383153086), (-18.532370553452417, -89.33548649218477), (-18.35518694813544, -89.26264837576531), (-18.125544781086234, -89.1983873370086), (-17.869090167711796, -89.13723437545757), (-17.63084576534729, -89.0703351854344), (-17.41059480534205, -89.00642441249437), (-17.206663303296445, -88.93412340324943), (-17.06352784735302, -88.83415142168134), (-16.903279061247947, -88.73364484958982), (-16.692945754135852, -88.6401680303806), (-16.477456739319443, -88.54394655137621), (-16.463678458642114, -88.35467175907398), (-16.503581622653385, -88.13566552807688), (-16.382164754647373, -87.98899196742695), (-16.095560456817623, -87.91926834964313), (-15.726684011401154, -87.90475580347609), (-15.373328637908678, -87.88605534954323), (-14.93713466074736, -87.87938474114034), (-14.516422373597917, -87.86827244169702), (-14.0639296171405, -87.88782528205917), (-13.569014771386415, -87.92481771784509), (-13.138469500516296, -87.92993175009977), (-12.70284976611738, -87.93532665845075), (-12.226393552749068, -87.95709309555545), (-11.68974426500118, -88.0031210259858), (-11.110032589436312, -88.0649101069605), (-10.529998358483514, -88.12334263755875), (-9.950114396340895, -88.17812960683172), (-9.369872026257665, -88.22959751138566), (-8.67159851758868, -88.3069703262597), (-7.927212011491676, -88.39201714785796), (-7.318588240154163, -88.44216799081065), (-6.692828473537666, -88.49464535043643), (-5.917087502983131, -88.57803237883574), (-5.101923151937173, -88.66822167631501), (-4.321819029196281, -88.74957478576874), (-3.552102895688133, -88.83560881342359), (-2.7455952380903046, -88.94144384614725), (-1.9209784141096655, -89.04559248133694), (-1.1259328927925942, -89.12671468284123), (-0.3436608243700565, -89.20459734638501), (0.4575220676471812, -89.29634675976624), (1.3011530007419108, -89.39366983692668), (2.1774323522939767, -89.48865603126066), (3.049755950374964, -89.57442684492126), (3.8460354204641636, -89.64494836907292), (4.615009971388346, -89.7085607704381), (5.4511616894378, -89.77461113476548), (6.346935709091245, -89.8469896190932), (7.304626110574338, -89.9304977196587), (8.243293386506707, -90.00279705455016), (9.122741108680838, -90.05288070881748), (9.984920940907855, -90.09382853712384), (10.750703361378605, -90.13505928829143), (11.484980112419464, -90.17192104937985), (12.29206401885719, -90.19669960078676), (13.196955095605169, -90.21776852006838), (14.28772678900231, -90.22694584231755), (15.419213941095805, -90.22863441683715), (16.46359845582382, -90.2313554144011), (17.486474097919746, -90.2202004999874), (18.511976768924775, -90.19054693357384), (19.45581753347661, -90.14881147389713), (20.25685084647352, -90.1071586440513), (21.010812777771186, -90.0616479682743), (21.76509091083394, -90.00622624448914), (22.502243880271926, -89.94519420779879), (23.160522956848222, -89.89446396636762), (23.798530370900203, -89.84058515368507), (24.50152341628603, -89.75947242231376), (25.169179491059126, -89.67647184232115), (25.76094619451559, -89.60551516378221), (26.350500600121432, -89.52801915047398), (26.961128039239583, -89.43754727889983), (27.5753670834017, -89.33850290054559), (28.161513230436057, -89.23736924359443), (28.774281387092007, -89.12166558808626), (29.452304668476867, -88.98098214795287), (30.133484245211008, -88.83043674493732), (30.808614355914877, -88.6731495588238), (31.46877841154485, -88.51160597845983), (32.039668875595936, -88.37238700398153), (32.594838769136416, -88.23155583833622), (33.21567369901438, -88.05938922460614), (33.84790416710487, -87.87479644184319), (34.47680641438558, -87.68166394629887), (35.06628342225406, -87.4952374027927), (35.59986386028268, -87.32435843311268), (36.10287933502315, -87.15915510408244), (36.594095815460605, -86.99235848532771), (37.076420794332506, -86.82299688524357), (37.54935202612687, -86.65151421057143), (38.01820164053271, -86.47592198996801), (38.47612244081949, -86.29930007622787), (38.907391953084804, -86.12865553829918), (39.28871116093587, -85.97539691660252), (39.637215189920894, -85.83303416882693), (39.99044585812348, -85.68467261882186), (40.30820709612488, -85.54891232077043), (40.52695798283197, -85.4559421652223), (40.68695944245397, -85.38804537937948), (40.836455160943075, -85.32335784231786), (40.97603141300629, -85.261636829927), (41.10020221746121, -85.20548344510566), (41.25528937584998, -85.1337043330511), (41.42435852059663, -85.05620711486017), (41.54286878603179, -85.00469831473136), (41.64155363112353, -84.96306253700004), (41.71511001666831, -84.93450352218518), (41.74991478095218, -84.92560947173484), (41.797671646544146, -84.91006797142312), (41.87628332133096, -84.87915955043191), (41.95447136852786, -84.847988254544), (42.029647929033715, -84.81805414190781), (42.09567918204026, -84.792886533122), (42.1335464445397, -84.78338094948134), (42.11764153856727, -84.80062571772793), (42.02350027268892, -84.85470987469988), (41.9242945494574, -84.90960091240504), (41.874043667905056, -84.93856968411787), (41.82687159613458, -84.96514840764897), (41.7765731248571, -84.99263872464988), (41.70071927409123, -85.0317684795844), (41.60877395297844, -85.07589451946951), (41.50800247299806, -85.12420890782195), (41.38831177383459, -85.1837562693499), (41.26907391849387, -85.24251538683674), (41.15374101276854, -85.29880699371272), (41.046022666502296, -85.3509077467986), (40.981010590657036, -85.38222252793474), (40.92971346041048, -85.40659024915598), (40.8301569619268, -85.45307254272866), (40.72969662258457, -85.49892718132641), (40.747353796624324, -85.48537132838175), (40.75611932528167, -85.47461431403339), (40.580173507715074, -85.55494403248221), (40.40805889344978, -85.63156066231303), (40.320211900656055, -85.664445106537), (40.23229588925089, -85.69664577064933), (40.144289325294885, -85.72817362852349), (40.056051312757276, -85.7590902243259), (39.97242690835361, -85.78705251868983), (39.86695102218033, -85.82404198830615), (39.740932017395735, -85.86543512075124), (39.631570591573976, -85.89373131626158), (39.54202543248181, -85.90985839135108), (39.45343722895886, -85.92415681773414), (39.326519875775766, -85.96145978937955), (39.21871065927282, -85.98510066640856), (39.10326834024322, -86.00152082268352), (38.972905832211964, -86.02313602288498), (38.91207273008218, -86.01188512551363), (38.86086862956235, -85.99485949457342), (38.73404103185707, -86.01040313438743), (38.61879575911626, -86.01978856073193), (38.54090340217449, -86.04199765140096), (38.47500888439638, -86.09048511876942), (38.475250877354455, -86.11107392338732), (38.46631007931492, -86.13576372192377), (38.42545952079068, -86.17466569008823), (38.384641124319145, -86.21352754066207), (38.367664463673634, -86.23657722927776), (38.3579356324933, -86.25473816144624), (38.32694651729712, -86.286994840928), (38.284918445870176, -86.32656033685733)]
# The preious trajectory
prev_foot_trajectory = [np.array([ -0.13716202, -94.43511628]), np.array([ -0.29163771, -94.41558483]), np.array([ -0.37642447, -94.39126448]), np.array([ -0.3759458 , -94.36323033]), np.array([ -0.37545847, -94.33520533]), np.array([ -0.45705353, -94.30683143]), np.array([ -0.53848633, -94.2784061 ]), np.array([ -0.57218338, -94.2559899 ]), np.array([ -0.61591005, -94.23515537]), np.array([ -0.69713904, -94.20671621]), np.array([ -0.77815259, -94.17823221]), np.array([ -0.81639947, -94.15635993]), np.array([ -0.85727334, -94.1349456 ]), np.array([ -0.93470187, -94.10609198]), np.array([ -1.01572344, -94.07773273]), np.array([ -1.05524057, -94.057833  ]), np.array([ -1.15455443, -94.04441216]), np.array([ -1.35534287, -94.03375551]), np.array([ -1.55903299, -94.02270835]), np.array([ -1.75596602, -94.01139121]), np.array([ -1.94603536, -93.99975288]), np.array([ -2.07773757, -93.98898383]), np.array([ -2.19612451, -93.97829773]), np.array([ -2.40445512, -93.96870014]), np.array([ -2.63123292, -93.96119   ]), np.array([ -2.79651741, -93.9546367 ]), np.array([ -2.9621231 , -93.94767121]), np.array([ -3.17608164, -93.93766892]), np.array([ -3.40014839, -93.92751751]), np.array([ -3.59283187, -93.9219335 ]), np.array([ -3.80144149, -93.91732691]), np.array([ -4.13787433, -93.90642035]), np.array([ -4.46616655, -93.89447996]), np.array([ -4.68915829, -93.88637315]), np.array([ -4.89936044, -93.87819209]), np.array([ -5.12885457, -93.87178147]), np.array([ -5.35802043, -93.8659453 ]), np.array([ -5.50039783, -93.85860166]), np.array([ -5.64899286, -93.85237611]), np.array([ -5.90410833, -93.84627877]), np.array([ -6.16394284, -93.84052786]), np.array([ -6.38980324, -93.83672593]), np.array([ -6.60404172, -93.83222731]), np.array([ -6.77938932, -93.8259286 ]), np.array([ -6.95817266, -93.81865414]), np.array([ -7.20741422, -93.8078828 ]), np.array([ -7.46536512, -93.7955176 ]), np.array([ -7.68669638, -93.78486622]), np.array([ -7.90614815, -93.77415645]), np.array([ -8.13847981, -93.7642979 ]), np.array([ -8.3861504 , -93.75358545]), np.array([ -8.69304855, -93.73619096]), np.array([ -8.98285552, -93.71866504]), np.array([ -9.17443302, -93.70609494]), np.array([ -9.3723225 , -93.69266636]), np.array([ -9.60057535, -93.67840788]), np.array([ -9.84184305, -93.6616349 ]), np.array([-10.10136718, -93.64158997]), np.array([-10.36218653, -93.62002834]), np.array([-10.6326947 , -93.59675968]), np.array([-10.91339395, -93.57157268]), np.array([-11.19900695, -93.54450499]), np.array([-11.48903899, -93.51548041]), np.array([-11.76670926, -93.48661419]), np.array([-12.03117474, -93.45851357]), np.array([-12.30332371, -93.42947494]), np.array([-12.58261693, -93.39920762]), np.array([-12.86007956, -93.36780963]), np.array([-13.13823957, -93.33480889]), np.array([-13.41184583, -93.30067188]), np.array([-13.6909619 , -93.26443508]), np.array([-13.97004477, -93.2265179 ]), np.array([-14.22602961, -93.18930289]), np.array([-14.44572448, -93.15468778]), np.array([-14.66881142, -93.11670642]), np.array([-14.94290792, -93.06778935]), np.array([-15.25702963, -93.00970553]), np.array([-15.5811354 , -92.94640837]), np.array([-15.86990272, -92.88452035]), np.array([-16.09692808, -92.82882585]), np.array([-16.31830309, -92.77016716]), np.array([-16.64336578, -92.68870638]), np.array([-16.98594617, -92.59812732]), np.array([-17.24567987, -92.51674401]), np.array([-17.46317371, -92.43800937]), np.array([-17.64499586, -92.36184023]), np.array([-17.82509522, -92.28148907]), np.array([-18.06385563, -92.18478206]), np.array([-18.28267927, -92.08629795]), np.array([-18.45218035, -91.99096916]), np.array([-18.62412056, -91.88977916]), np.array([-18.78484965, -91.78647215]), np.array([-18.92785195, -91.68320751]), np.array([-19.04941756, -91.5815215 ]), np.array([-19.16883749, -91.4760205 ]), np.array([-19.2801518 , -91.36747988]), np.array([-19.37789329, -91.25736616]), np.array([-19.44119365, -91.15003385]), np.array([-19.4831676 , -91.04608645]), np.array([-19.52033308, -90.94680899]), np.array([-19.54875076, -90.8479513 ]), np.array([-19.58739789, -90.74128886]), np.array([-19.59743526, -90.63741056]), np.array([-19.56351884, -90.53959814]), np.array([-19.52477571, -90.43959434]), np.array([-19.4994568 , -90.33233849]), np.array([-19.44446736, -90.2332942 ]), np.array([-19.33686924, -90.15255   ]), np.array([-19.22524706, -90.07229627]), np.array([-19.17423142, -89.97448048]), np.array([-19.12529377, -89.87568303]), np.array([-18.98513798, -89.79872286]), np.array([-18.85313041, -89.71913793]), np.array([-18.77671862, -89.62494056]), np.array([-18.70100454, -89.52857412]), np.array([-18.6281702 , -89.42853832]), np.array([-18.53237055, -89.33548649]), np.array([-18.35518695, -89.26264838]), np.array([-18.12554478, -89.19838734]), np.array([-17.86909017, -89.13723438]), np.array([-17.63084577, -89.07033519]), np.array([-17.41059481, -89.00642441]), np.array([-17.2066633, -88.9341234]), np.array([-17.06352785, -88.83415142]), np.array([-16.90327906, -88.73364485]), np.array([-16.69294575, -88.64016803]), np.array([-16.47745674, -88.54394655]), np.array([-16.46367846, -88.35467176]), np.array([-16.50358162, -88.13566553]), np.array([-16.38216475, -87.98899197]), np.array([-16.09556046, -87.91926835]), np.array([-15.72668401, -87.9047558 ]), np.array([-15.37332864, -87.88605535]), np.array([-14.93713466, -87.87938474]), np.array([-14.51642237, -87.86827244]), np.array([-14.06392962, -87.88782528]), np.array([-13.56901477, -87.92481772]), np.array([-13.1384695 , -87.92993175]), np.array([-12.70284977, -87.93532666]), np.array([-12.22639355, -87.9570931 ]), np.array([-11.68974427, -88.00312103]), np.array([-11.11003259, -88.06491011]), np.array([-10.52999836, -88.12334264]), np.array([ -9.9501144 , -88.17812961]), np.array([ -9.36987203, -88.22959751]), np.array([ -8.67159852, -88.30697033]), np.array([ -7.92721201, -88.39201715]), np.array([ -7.31858824, -88.44216799]), np.array([ -6.69282847, -88.49464535]), np.array([ -5.9170875 , -88.57803238]), np.array([ -5.10192315, -88.66822168]), np.array([ -4.32181903, -88.74957479]), np.array([ -3.5521029 , -88.83560881]), np.array([ -2.74559524, -88.94144385]), np.array([ -1.92097841, -89.04559248]), np.array([ -1.12593289, -89.12671468]), np.array([ -0.34366082, -89.20459735]), np.array([  0.45752207, -89.29634676]), np.array([  1.301153  , -89.39366984]), np.array([  2.17743235, -89.48865603]), np.array([  3.04975595, -89.57442684]), np.array([  3.84603542, -89.64494837]), np.array([  4.61500997, -89.70856077]), np.array([  5.45116169, -89.77461113]), np.array([  6.34693571, -89.84698962]), np.array([  7.30462611, -89.93049772]), np.array([  8.24329339, -90.00279705]), np.array([  9.12274111, -90.05288071]), np.array([  9.98492094, -90.09382854]), np.array([ 10.75070336, -90.13505929]), np.array([ 11.48498011, -90.17192105]), np.array([ 12.29206402, -90.1966996 ]), np.array([ 13.1969551 , -90.21776852]), np.array([ 14.28772679, -90.22694584]), np.array([ 15.41921394, -90.22863442]), np.array([ 16.46359846, -90.23135541]), np.array([ 17.4864741, -90.2202005]), np.array([ 18.51197677, -90.19054693]), np.array([ 19.45581753, -90.14881147]), np.array([ 20.25685085, -90.10715864]), np.array([ 21.01081278, -90.06164797]), np.array([ 21.76509091, -90.00622624]), np.array([ 22.50224388, -89.94519421]), np.array([ 23.16052296, -89.89446397]), np.array([ 23.79853037, -89.84058515]), np.array([ 24.50152342, -89.75947242]), np.array([ 25.16917949, -89.67647184]), np.array([ 25.76094619, -89.60551516]), np.array([ 26.3505006 , -89.52801915]), np.array([ 26.96112804, -89.43754728]), np.array([ 27.57536708, -89.3385029 ]), np.array([ 28.16151323, -89.23736924]), np.array([ 28.77428139, -89.12166559]), np.array([ 29.45230467, -88.98098215]), np.array([ 30.13348425, -88.83043674]), np.array([ 30.80861436, -88.67314956]), np.array([ 31.46877841, -88.51160598]), np.array([ 32.03966888, -88.372387  ]), np.array([ 32.59483877, -88.23155584]), np.array([ 33.2156737 , -88.05938922]), np.array([ 33.84790417, -87.87479644]), np.array([ 34.47680641, -87.68166395]), np.array([ 35.06628342, -87.4952374 ]), np.array([ 35.59986386, -87.32435843]), np.array([ 36.10287934, -87.1591551 ]), np.array([ 36.59409582, -86.99235849]), np.array([ 37.07642079, -86.82299689]), np.array([ 37.54935203, -86.65151421]), np.array([ 38.01820164, -86.47592199]), np.array([ 38.47612244, -86.29930008]), np.array([ 38.90739195, -86.12865554]), np.array([ 39.28871116, -85.97539692]), np.array([ 39.63721519, -85.83303417]), np.array([ 39.99044586, -85.68467262]), np.array([ 40.3082071 , -85.54891232]), np.array([ 40.52695798, -85.45594217]), np.array([ 40.68695944, -85.38804538]), np.array([ 40.83645516, -85.32335784]), np.array([ 40.97603141, -85.26163683]), np.array([ 41.10020222, -85.20548345]), np.array([ 41.25528938, -85.13370433]), np.array([ 41.42435852, -85.05620711]), np.array([ 41.54286879, -85.00469831]), np.array([ 41.64155363, -84.96306254]), np.array([ 41.71511002, -84.93450352]), np.array([ 41.74991478, -84.92560947]), np.array([ 41.79767165, -84.91006797]), np.array([ 41.87628332, -84.87915955]), np.array([ 41.95447137, -84.84798825]), np.array([ 42.02964793, -84.81805414]), np.array([ 42.09567918, -84.79288653]), np.array([ 42.13354644, -84.78338095]), np.array([ 42.11764154, -84.80062572]), np.array([ 42.02350027, -84.85470987]), np.array([ 41.92429455, -84.90960091]), np.array([ 41.87404367, -84.93856968]), np.array([ 41.8268716 , -84.96514841]), np.array([ 41.77657312, -84.99263872]), np.array([ 41.70071927, -85.03176848]), np.array([ 41.60877395, -85.07589452]), np.array([ 41.50800247, -85.12420891]), np.array([ 41.38831177, -85.18375627]), np.array([ 41.26907392, -85.24251539]), np.array([ 41.15374101, -85.29880699]), np.array([ 41.04602267, -85.35090775]), np.array([ 40.98101059, -85.38222253]), np.array([ 40.92971346, -85.40659025]), np.array([ 40.83015696, -85.45307254]), np.array([ 40.72969662, -85.49892718]), np.array([ 40.7473538 , -85.48537133]), np.array([ 40.75611933, -85.47461431]), np.array([ 40.58017351, -85.55494403]), np.array([ 40.40805889, -85.63156066]), np.array([ 40.3202119 , -85.66444511]), np.array([ 40.23229589, -85.69664577]), np.array([ 40.14428933, -85.72817363]), np.array([ 40.05605131, -85.75909022]), np.array([ 39.97242691, -85.78705252]), np.array([ 39.86695102, -85.82404199]), np.array([ 39.74093202, -85.86543512]), np.array([ 39.63157059, -85.89373132]), np.array([ 39.54202543, -85.90985839]), np.array([ 39.45343723, -85.92415682]), np.array([ 39.32651988, -85.96145979]), np.array([ 39.21871066, -85.98510067]), np.array([ 39.10326834, -86.00152082]), np.array([ 38.97290583, -86.02313602]), np.array([ 38.91207273, -86.01188513]), np.array([ 38.86086863, -85.99485949]), np.array([ 38.73404103, -86.01040313]), np.array([ 38.61879576, -86.01978856]), np.array([ 38.5409034 , -86.04199765]), np.array([ 38.47500888, -86.09048512]), np.array([ 38.47525088, -86.11107392]), np.array([ 38.46631008, -86.13576372]), np.array([ 38.42545952, -86.17466569]), np.array([ 38.38464112, -86.21352754]), np.array([ 38.36766446, -86.23657723]), np.array([ 38.35793563, -86.25473816]), np.array([ 38.32694652, -86.28699484]), np.array([ 38.28491845, -86.32656034])]


#link lengths:
#Given in the doc
ground_height =92.4 #Height from hip to ground (cm)

l1 = 43.2                                                           #Thigh Length : (cm)
l2 = 40.6                                                           #Knee Length : (cm)

ankle_height = 8.6                                                  #Ankle Length : (cm)
foot_forward_len = 19.5                                             #Front Foot Length
foot_backward_len = 26.2 - 19.5                                     #Back Foot Length

#Plotting the figure for geberating frames
fig,ax = plt.subplots()

# Apending the coordinates for different links
hip_positions = []
l1_end_positions = []
l2_end_positions = []
l3_end_positions = []
foot_front_ends = []
foot_back_ends = []


for t1,t2,t3 in zip(q1,q2,t):
    hip_position = 2.5*np.sin(((np.pi/2.8)*t3))

    l1_end_position_x = l1*np.cos(t1 +  np.pi/2)
    l1_end_position_y = l1*np.sin(t1+ np.pi/2) +hip_position
    l1_end_position = np.array([l1_end_position_x,l1_end_position_y])
    l2_end_position_x = l1_end_position_x + l2*np.cos((t1 - t2) + np.pi/2)
    l2_end_position_y = l1_end_position_y + l2*np.sin((t1 - t2) + np.pi/2)
    l2_end_position = np.array([l2_end_position_x,l2_end_position_y])

    l3_end_position_x = l1_end_position_x + (l2 + ankle_height)*(np.cos((t1 - t2) + np.pi/2))
    l3_end_position_y = l1_end_position_y + (l2 + ankle_height)*(np.sin((t1 - t2) + np.pi/2))
    l3_end_position = np.array([l3_end_position_x,l3_end_position_y])
    
    foot_front_end_x = l3_end_position_x + foot_backward_len*(np.cos(t1 - t2))
    foot_front_end_y = l3_end_position_y + foot_backward_len*(np.sin(t1 - t2))
    foot_front_end = np.array([foot_front_end_x,foot_front_end_y])

    foot_back_end_x = l3_end_position_x - foot_forward_len*(np.cos(t1 - t2))
    foot_back_end_y = l3_end_position_y - foot_forward_len*(np.sin(t1 - t2))
    foot_back_end = np.array([foot_back_end_x,foot_back_end_y])

    hip_positions.append(hip_position)
    l1_end_positions.append(l1_end_position)
    l2_end_positions.append(l2_end_position)
    l3_end_positions.append(l3_end_position)
    foot_front_ends.append(foot_front_end)
    foot_back_ends.append(foot_back_end)


# Various attributes for the animation
gait_x = [pos[0] for pos in l2_end_positions]
gait_y = [pos[1] for pos in l2_end_positions]
# ax.scatter(gait_x, gait_y, s = 0.6, alpha = 0.5)

l1_end_circle = plt.Circle([0,0], radius=4, fc='#0077b6', alpha = 0.5)
l2_end_circle = plt.Circle([0,0], radius=4, fc='g',  alpha = 0.5)
l1_line = plt.Line2D([], [], color = "#0077b6" , lw=2.5)
l2_line = plt.Line2D([], [], color = '#0077b6', lw=2.5)
foot_line = plt.Line2D([], [], color = '#0077b6', lw=2.5)
time_text = ax.text(0.02, 0.95, 'time (seconds): 0.00', transform = ax.transAxes)


ax.axhline(-(l1 + l2), alpha = 0)
ax.axhline((l1 + l2), alpha = 0)
ax.axvline((l1 + l2), alpha = 0)
ax.axvline(-(l1 + l2), alpha = 0)
ax.axhline(-ground_height, color = 'g') # Ground Line

ax.add_line(l2_line)
ax.add_patch(foot_line)
ax.add_line(l1_line)
ax.add_patch(l1_end_circle)
ax.add_patch(l2_end_circle)

plt.axis('square')

coll_points = []
def animate(i):
    t_ = t[i]
     
    l1_line.set_data((0,l1_end_positions[i][0]),(hip_positions[i], l1_end_positions[i][1]))
    l2_line.set_data((l1_end_positions[i][0],l3_end_positions[i][0]),(l1_end_positions[i][1],l3_end_positions[i][1]))
    foot_line.set_data((foot_back_ends[i][0], foot_front_ends[i][0]),(foot_back_ends[i][1], foot_front_ends[i][1]))

    l1_end_circle.set_center(l1_end_positions[i])
    l2_end_circle.set_center(l2_end_positions[i])
      
    time_text.set_text('time (seconds): %.2f' % t_)
    
    if (foot_front_ends[i][1] < -ground_height) or (foot_back_ends[i][1] < -ground_height):
        foot_line.set_color('r')
        coll_points.append(i)
    else:
        foot_line.set_color('#0077b6')

    return l1_line, l2_line, l1_end_circle, l2_end_circle, foot_line, time_text

anim = animation.FuncAnimation(fig, animate,
                            frames = 280,
                            interval = 2.8,
                            blit = True)

ax.set_title('Moving Hip Joint: After Increment')
# ax.scatter([x[0] for x in prev_foot_trajectory], [x[1] for x in prev_foot_trajectory], s = 0.6, color = 'r', alpha = 0.4)
# ax.scatter([x[0] for x in foot_back_ends], [x[1] for x in foot_back_ends], s = 0.6, color = 'g', alpha = 1)

ax.grid()
plt.show()

# writergif = animation.PillowWriter(fps=100) 
# anim.save(r'C:\\Users\\videh\\OneDrive\Documents\Sem 5\\ME 639\\Coffee Bots\Workspace\\gifs\\hip_move_after.gif', writer = writergif)